import{_ as a,c as t,o as r,j as i,a0 as n,a as l,t as h}from"./chunks/framework.Do9hWntK.js";const m=JSON.parse('{"title":"Metric Server","description":"Setup details","frontmatter":{"title":"Metric Server","description":"Setup details"},"headers":[],"relativePath":"7-Monitoring/Metric-server.md","filePath":"7-Monitoring/Metric-server.md"}'),p={name:"7-Monitoring/Metric-server.md"},o={id:"frontmatter-title",tabindex:"-1"};function k(e,s,d,c,g,F){return r(),t("div",null,[i("h1",o,[l(h(e.$frontmatter.title)+" ",1),s[0]||(s[0]=i("a",{class:"header-anchor",href:"#frontmatter-title","aria-label":'Permalink to "{{ $frontmatter.title }}"'},"​",-1))]),s[1]||(s[1]=n(`<p>Metrics Server is a lightweight Kubernetes component that collects resource usage data (CPU, memory) from nodes and Pods. It aggregates this information and makes it available via the Metrics API, which is used by components like Horizontal Pod Autoscaler (HPA) and kubectl top.Main usage is monitoring and autoscaling based on real-time resource usage.</p><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">​</a></h2><ol><li><strong>Scrape</strong> – Metrics server queries each kubelet on every node for Pod and node resource usage (CPU, memory).</li><li><strong>Aggregate</strong> – Collected metrics are aggregated across all nodes.</li><li><strong>Expose</strong> - Metrics are then exposed using the Kubernetes Metrics API (metrics.k8s.io)</li><li><strong>Consume</strong> - Consumed by HPA for autoscaling and when kubectl top query the Metrics API to read current usage.</li></ol><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>Metrics Server does not store historical data, it only exposes current usage.</p></div><h2 id="installing-metric-server" tabindex="-1">Installing Metric Server <a class="header-anchor" href="#installing-metric-server" aria-label="Permalink to &quot;Installing Metric Server&quot;">​</a></h2><p>Metric server is a default add-on that is deployed together with initial cluster setup. If however it is not present or is ommited through a configuration during installation then we can deploy it explicitly using Helm.</p><p>Official Helm chart repo: <a href="https://github.com/kubernetes-sigs/metrics-server/tree/master/charts/metrics-server" target="_blank" rel="noreferrer">Metric Server</a></p><ol><li>Prepare the repository</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metrics-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://kubernetes-sigs.github.io/metrics-server/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre></div><ol start="2"><li>Install in the preferred namespace</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metrics-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metrics-server/metrics-server</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --namespace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">namespac</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --wait</span></span></code></pre></div><ol start="3"><li>Verify setup</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Confirm metric server pod status </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">namespac</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metrics-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check resource consumption</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> top</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nodes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> top</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span></span></code></pre></div>`,13))])}const y=a(p,[["render",k]]);export{m as __pageData,y as default};
